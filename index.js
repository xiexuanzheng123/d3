第一次写博客，写的不好勿怪！！！<br>此博客是通过d3 v4 实现一个饼状图，并添加了折线标注；代码如下<br><br>let self = this;<br>var tooltip = d3.select("body").append("div").attr("class", "toolTip");<br>let ele = document.getElementById(this.svg);<br>var svg = d3.select("#"+this.svg),<br>  width = +ele.clientWidth,<br>  height = +ele.clientHeight,<br>  radius = Math.min(width-80, height-80) / 2,<br>  g = svg.append("g").attr("transform", "translate(" + width / 2 + "," + (height/2) + ")");<br>/*console.log("width:"+ele.clientWidth);<br>console.log("heigth:"+ele.clientHeight);*/<br>var color = d3.scaleOrdinal(["#74F590", "#F56464", "#64BCF5"]);<br>
<br>var pie = d3.pie()<br>  .sort(null)<br>  .value(function(d) { return d.value; });<br><br>var path = d3.arc()<br>  .outerRadius(radius)<br>  .innerRadius(35);<br><br>var path0 = d3.arc()<br>  .outerRadius(radius+10)<br>  .innerRadius(35);<br><br>var label = d3.arc()<br>  .outerRadius(radius - 20)<br>  .innerRadius(radius - 20);<br><br>var label0 = d3.arc()<br>  .outerRadius(radius + 20)<br>  .innerRadius(radius + 20);<br><br>let data = [<br>  {"area": "正在运行 ", "value": 2704659},<br>  {"area": "异常终止 ", "value": 4499890},<br>  {"area": "已完成", "value": 2159981}<br>];<br><br><br>  var arc = g.selectAll(".arc")<br>    .data(pie(data))<br>    .enter().append("g")<br>    .attr("class", "arc");<br><br>arc.on("mouseover",function(d,i){<br>  d3.select(this).select("path")<br>    .attr("d",path0);<br>  tooltip<br>    .style("left", d3.event.pageX - 50 + "px")<br>    .style("top", d3.event.pageY - 70 + "px")<br>    .style("display", "inline-block")<br>    .html(<br>      "<div>"+(d.data.area) +"</div>"+<br>      "<div class='clearfix'><div class='pull-left toolTipCircle circle1'></div><div class='pull-left'>"+"执行个数："+(d.value)+"个</div></div>"<br>    );<br>});<br><br>arc.on("mouseout",function(d,i){<br>  d3.select(this).select("path")<br>    .attr("d",path);<br>  tooltip.style("display", "none");<br>});<br><br>  arc.append("path")<br>    .attr("d", path)<br>    .attr("fill", function(d) { return color(d.data.area); });<br><br>  arc.append("text")<br>    .attr("transform", function(d) {<br>      var x2 =label0.centroid(d)[0];<br>      var y2 =label0.centroid(d)[1];<br>      var x3 = x2<0?x2-70:x2+30;<br>      return "translate(" + x3 + "," + y2 + ")";<br>    })<br>    .attr("dy", "0.35em")<br>    .text(function(d) { return d.data.area; });<br><br>  arc.append("polyline")<br>    .attr("points",function(d){<br>      var x1 =label.centroid(d)[0];<br>      var y1 =label.centroid(d)[1];<br>      var x2 =label0.centroid(d)[0];<br>      var y2 =label0.centroid(d)[1];<br>      var x3 = x2<0?x2-30:x2+30;<br>      return x3+","+y2+" "+x2+","+y2+" "+x1+","+y1;<br>    })<br>    .style("fill","none")<br>    .style("stroke","rgb(99,99,99)")<br>    .style("stroke-width","1")<br><br>